# Практика 3
## Макаров Михаил Максимович
## ББМО-02-23
Была создана ВМ с ОС Ubuntu
Wazuh — это бесплатная платформа с открытым исходным кодом для обнаружения угроз, мониторинга безопасности, реагирования на инциденты и соблюдения нормативных требований.
___
#### [Начало](#начало)
[Сетевой обмен](#сетевой-обмен)
[Разворачиваем сервер Wazuh](#разворачиваем-сервер-Wazuh)
[Подключаем агента](#подключаем-агента)
[Проверяем агента](#проверяем-агента)
[Проверка целостности файлов](#проверка-целостности-файлов)
[Выявление уязвимостей в соотстветвии с документацияей](#выявление-уязвимостей-в-соотстветвии-с-документацияей)
[Выявление скрытых процессов](#выявление-скрытых-процессов)
[Наcтрока выявления SQL-инъекций](#наcтрока-выявления-SQL-инъекций)
[Выявление web shell attack](#выявление-web-shell-attack)
#### [Результат](#результат)
___

### Начало <a name="начало"></a>

#### 2 ВМ
Создали 2 ВМ с OS Ubuntu, client и server

|![](images/3/Снимок%20экрана%202024-12-01%20200702.png)|
|:--:|
|*2 ВМ*|

#### Сетевой обмен <a name="сетевой-обмен"></a>

Настроили сетевой мост на клиенте и сервере.

|![](images/3/Снимок%20экрана%202024-12-01%20200716.png)|
|:--:|
|*Сетевой мост сервер*|

|![](images/3/Снимок%20экрана%202024-12-01%20200730.png)|
|:--:|
|*Сетевой мост клиент*|

### Разворачиваем сервер Wazuh <a name="разворачиваем-сервер-Wazuh"></a>

- Установили mc для удобства
- Обновили список пакетов
- Установили новые пакеты
- получили скрипт для установки, в конце концов определившись с версией
- Выполнили уставноку
- Переименовали машину в сервер

|![](images/3/Снимок%20экрана%202024-12-02%20001745.png)|
|:--:|
|*Разворачиваем сервер*|

|![](images/3/Снимок%20экрана%202024-12-01%20201348.png)|
|:--:|
|*Процесс установки сервера*|

|![](images/3/Снимок%20экрана%202024-12-01%20201531.png)|
|:--:|
|*Процесс установки сервера*|

|![](images/3/Снимок%20экрана%202024-12-01%20202004.png)|
|:--:|
|*Процесс установки сервера*|

Сделали 3 скриншота (больше) уставноки сервера, наскучило, пошли погуляли, вернулись...

|![](images/3/Снимок%20экрана%202024-12-01%20202230.png)|
|:--:|
|*Установка сервера завершена*|

|![](images/3/Снимок%20экрана%202024-12-01%20203028.png)|
|:--:|
|*Запускаем в брауезере*|

|![](images/3/Снимок%20экрана%202024-12-01%20203039.png)|
|:--:|
|*Окно ввода логина и пароля*|

|![](images/3/Снимок%20экрана%202024-12-01%20203145.png)|
|:--:|
|*Работает*|

### Подключаем агента <a name="подключаем-агента"></a>

Тут Ubuntu захотела обновиться, ну, ладно, обновляем

|![](images/3/Снимок%20экрана%202024-12-01%20201356.png)|
|:--:|
|*Процесс обновления*|

|![](images/3/Снимок%20экрана%202024-12-01%20201520.png)|
|:--:|
|*Обнолвение готово*|

Не перезапускаем машину, сначала переименуем

|![](images/3/Снимок%20экрана%202024-12-01%20201837.png)|
|:--:|
|*Переименование хоста*|

|![](images/3/Снимок%20экрана%202024-12-01%20201940.png)|
|:--:|
|*Работаем из под рут*|

Устанавливаем клиента wazuh

|![](images/3/Снимок%20экрана%202024-12-01%20203920.png)|
|:--:|
|*История команд*|

|![](images/3/Снимок%20экрана%202024-12-01%20203955.png)|
|:--:|
|*Статус wazuh-agent*|

### Проверка связи между машинами
|![](images/3/Снимок%20экрана%202024-12-01%20202801.png)|
|:--:|
|*Смотрим IP*|

|![](images/3/Снимок%20экрана%202024-12-01%20202826.png)|
|:--:|
|*Пингуем с двух сторон*|

### Проверяем агента <a name="проверяем-агента"></a>

|![](images/3/Снимок%20экрана%202024-12-01%20204155.png)|
|:--:|
|*Агент добавлен*|

|![](images/3/Снимок%20экрана%202024-12-01%20211554.png)|
|:--:|
|*DashBoard агента*|

|![](images/3/Снимок%20экрана%202024-12-01%20211607.png)|
|:--:|
|*Возможности*|

|![](images/3/Снимок%20экрана%202024-12-01%20211623.png)|
|:--:|
|*Просканировали уязвимые пакеты по инструкции из интернетов*|

### Проверка целостности файлов <a name="проверка-целостности-файлов"></a>

На клиенте:

|![](images/3/Снимок%20экрана%202024-12-01%20224040.png)|
|:--:|
|*Говорим проверять в реальном времени всё в директории "/_test"*|

|![](images/3/Снимок%20экрана%202024-12-01%20224125.png)|
|:--:|
|*Создаём файл|

|![](images/3/Снимок%20экрана%202024-12-01%20224052.png)|
|:--:|
|*Рестартим*|

|![](images/3/Снимок%20экрана%202024-12-01%20224135.png)|
|:--:|
|*Редактируем файл*|

На сервере:

|![](images/3/Снимок%20экрана%202024-12-01%20224159.png)|
|:--:|
|*Наблюдаем сообщения о насилии над директорией*|

### Выявление уязвимостей в соотстветвии с документацияей <a name="выявление-уязвимостей-в-соотстветвии-с-документацияей"></a>

|![](images/3/Снимок%20экрана%202024-12-01%20225628.png)|
|:--:|
|*Меняем конфиг*|

|![](images/3/Снимок%20экрана%202024-12-01%20230031.png)|
|:--:|
|*Видим уязвимости пакетов на клиенте*|

|![](images/3/Снимок%20экрана%202024-12-01%20230329.png)|
|:--:|
|*"События"*|

### Выявление скрытых процессов <a name="выявление-скрытых-процессов"></a>

|![](images/3/Снимок%20экрана%202024-12-01%20230619.png)|
|:--:|
|*Меняем конфиг*|

|![](images/3/Снимок%20экрана%202024-12-01%20230647.png)|
|:--:|
|*История действий*|

|![](images/3/Снимок%20экрана%202024-12-01%20230710.png)|
|:--:|
|*Выполняем сборку*|

|![](images/3/Снимок%20экрана%202024-12-01%20230731.png)|
|:--:|
|*История создания проблемы*|

|![](images/3/Снимок%20экрана%202024-12-01%20230920.png)|
|:--:|
|*Играемся, согласно примерам*|

|![](images/3/Снимок%20экрана%202024-12-01%20230934.png)|
|:--:|
|*В момент ничего не выводит, затем выводит*|

|![](images/3/Снимок%20экрана%202024-12-01%20231018.png)|
|:--:|
|*Наблюдаем выявленные аномалии на сервере*|

|![](images/3/Снимок%20экрана%202024-12-01%20231129.png)|
|:--:|
|*Настраиваем фильтр*|

|![](images/3/Снимок%20экрана%202024-12-01%20231143.png)|
|:--:|
|*После фильтрации*|

### Наcтрока выявления SQL-инъекций <a name="наcтрока-выявления-SQL-инъекций"></a>

|![](images/3/Снимок%20экрана%202024-12-01%20231342.png)|
|:--:|
|*Ставим apache*|

|![](images/3/Снимок%20экрана%202024-12-01%20231402.png)|
|:--:|
|*Немного настраиваем*|

|![](images/3/Снимок%20экрана%202024-12-01%20231413.png)|
|:--:|
|*Проверяем*|

|![](images/3/Снимок%20экрана%202024-12-01%20231451.png)|
|:--:|
|*Проверяем в браузере*|

|![](images/3/Снимок%20экрана%202024-12-01%20231615.png)|
|:--:|
|*Снова редачим конфиг*|

|![](images/3/Снимок%20экрана%202024-12-01%20231641.png)|
|:--:|
|*Перезапускаем*|

|![](images/3/Снимок%20экрана%202024-12-01%20231718.png)|
|:--:|
|*Проводим атаку с клиента*|

|![](images/3/Снимок%20экрана%202024-12-01%20231738.png)|
|:--:|
|*Проводим атаку с сервера для закрепления результата*|

|![](images/3/Снимок%20экрана%202024-12-01%20231808.png)|
|:--:|
|*Сразу фильтруем*|

|![](images/3/Снимок%20экрана%202024-12-01%20231817.png)|
|:--:|
|*Видим 2 наших недобросовестных действия*|

|![](images/3/Снимок%20экрана%202024-12-01%20232222.png)|
|:--:|
|*История действий на клиенте*|

### Выявление web shell attack <a name="выявление-web-shell-attack"></a>

|![](images/3/Снимок%20экрана%202024-12-01%20232745.png)|
|:--:|
|*Ставим php*|

|![](images/3/Снимок%20экрана%202024-12-01%20232838.png)|
|:--:|
|*И снова конфиг*|

|![](images/3/Снимок%20экрана%202024-12-01%20232948.png)|
|:--:|
|*Создаём правило*|

|![](images/3/Снимок%20экрана%202024-12-01%20233006.png)|
|:--:|
|*История действий*|

|![](images/3/Снимок%20экрана%202024-12-01%20233104.png)|
|:--:|
|*Надо было конфиг ставить на проверку целостности :-)*|

|![](images/3/Снимок%20экрана%202024-12-01%20233130.png)|
|:--:|
|*Рестарт и просмотр id*|

|![](images/3/Снимок%20экрана%202024-12-01%20233248.png)|
|:--:|
|*Ставим ещё пакетики*|

|![](images/3/Снимок%20экрана%202024-12-01%20233320.png)|
|:--:|
|*Редачим правила*|

|![](images/3/Снимок%20экрана%202024-12-01%20233330.png)|
|:--:|
|*Рестарт всего*|

|![](images/3/Снимок%20экрана%202024-12-01%20233409.png)|
|:--:|
|*Делаем ещё правил*|

|![](images/3/Снимок%20экрана%202024-12-01%20233504.png)|
|:--:|
|*Кинфиг наше всё*|

|![](images/3/Снимок%20экрана%202024-12-01%20233550.png)|
|:--:|
|*Много правил не бывает*|

|![](images/3/Снимок%20экрана%202024-12-01%20233613.png)|
|:--:|
|*Много правил не бывает 2*|

|![](images/3/Снимок%20экрана%202024-12-01%20233654.png)|
|:--:|
|*Закрепляем результат*|

|![](images/3/Снимок%20экрана%202024-12-01%20234117.png)|
|:--:|
|*Проводим махинации*|

|![](images/3/Снимок%20экрана%202024-12-01%20234149.png)|
|:--:|
|*Продолжаем ...*|

|![](images/3/Снимок%20экрана%202024-12-01%20234307.png)|
|:--:|
|*Ещё немного махинаций*|

|![](images/3/Снимок%20экрана%202024-12-01%20234414.png)|
|:--:|
|*Проверяем*|

|![](images/3/Снимок%20экрана%202024-12-01%20234448.png)|
|:--:|
|*Немного фильтров*|

|![](images/3/Снимок%20экрана%202024-12-01%20234459.png)|
|:--:|
|*Все события*|

## Результат <a name="результат"></a>
## Красивый отчёт подготовлен ("Продемонстируйте работу настроенных механизмов в отчете со скриншотами.")

### В рамках выполнения ПРЗ 3 по использованию Wazuh были выполнены следующие задачи:

- Развертывание виртуальных машин:
	- Были развернуты две виртуальные машины: сервер и агенты.
- Использовались VirtualBox и Ubuntu Server для развертывания.
	- Обеспечение сетевого обмена:
- Настроен сетевой обмен между виртуальными машинами с использованием документации VirtualBox.
	- Развертывание сервера Wazuh:
- На одной из виртуальных машин был развернут сервер Wazuh.
	- Следовали инструкциям из документации Wazuh для установки сервера.
- Подключение агента:
	- Подключили агента к серверу Wazuh, следуя документации.
- Анализ обнаруженных уязвимостей:
	- Убедились, что агент установлен и работает корректно.
- Зашли на веб- интерфейс сервера Wazuh и изучили предлагаемые пункты меню сканирования.
	- Проанализировали обнаруженные уязвимости.
- Создание проверки целостности файлов:
	- Настроили проверку целостности файлов, следуя документации.
- Настройка выявления уязвимостей:
	- Настроили выявление уязвимостей в соответствии с документацией.
- Настройка выявления скрытых процессов:
	- Настроили выявление скрытых процессов, следуя документации.
- Настройка выявления SQL- инъекций:
	- Настроили выявление SQL- инъекций, следуя документации.
- Настройка выявления web shell attack:
	- Настроили выявление web shell attack, следуя документации.
- Демонстрация работы настроенных механизмов:
	- Продемонстрировали работу настроенных механизмов в отчете со скриншотами.

|![](images/3/Снимок%20экрана%202024-12-02%20010105.png)|
|:--:|
|*Красота длиною в 3 часа жизни*|

# Практика 3
## Выполнил студент группы ББМО-02-23
## Макаров Михаил Максимович